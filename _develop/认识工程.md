# 工程目录结构

```
.
├── _develop
├── examples
├── gulp
├── internals //构建脚本及辅助插件
├── packages //组件源码
│   ├── design
│   ├── openinula
│   ├── react
│   ├── renderless //🌟组件逻辑
│   ├── solid
│   ├── theme //🌟组件样式
│   ├── theme-mobile
│   ├── theme-saas
│   ├── vue //🌟组件模版
│   ├── vue-common //vue适配层
│   ├── vue-icon
│   ├── vue-icon-saas
│   ├── vue-locale //国际化
│   └── vue-saas-common
└── patches
```

# package.json

```
"preinstall": "npx only-allow pnpm"  -- 本项目只允许使用 pnpm 管理依赖
"dev": "pnpm build:entry && gulp themeConcat -w & pnpm -C examples/vue3 dev", --vue3开发调试
"dev:saas": "pnpm create:icon-saas && pnpm build:entry && pnpm -C examples/vue3 dev:saas", --创建saas图标ts文件 + vue3开发调试
"dev2": "pnpm build:entry && gulp themeConcat -w & pnpm -C examples/vue2 dev", -- vue2开发调试
"dev2:saas": "pnpm create:icon-saas && pnpm build:entry && pnpm -C examples/vue2 dev:saas", -- 创建saas图标ts文件 + vue2.6开发调试
"dev2.7": "pnpm build:entry && gulp themeConcat -w & pnpm -C examples/vue2.7 dev", -- vue2.7开发调试
"dev2.7:saas": "pnpm create:icon-saas && pnpm build:entry && pnpm -C examples/vue2.7 dev:saas", -- 创建saas图标ts文件 + vue2.7开发调试
```

# dev的demo是如何被加载的

examples目录下有vue2、vue2.7、vue3，分别对应vue的不同版本，用于开发模式下的demo展示和调试

但是各自目录下没有对应的组件示例代码，那么demo是如何被加载的呢。

从最终呈现的结果来看，一个示例页面中，外框部分代码位于examples/docs， demo示例代码都位于examples/sites中。

1. vue3->docs

查看examples/vue3的vite.config.ts配置可知，申明了resolve.alias:

```
'@': pathFromWorkspaceRoot('examples/docs/newsrc')
```

通过@别名指向 exmales/docs/newsrc。

入口文件main.ts中：

```
import App from '@/App.vue'
```

2. docs->sites

查看 examples/docs/newsrc/pc.vue:34

```
 <component :is="state.comp" v-loading="state.demoLoading"></component>
```

结合 examples/docs/newsrc/pc.vue:247

```
    async function _switchDemo() {
      modeState.demoId = state.currDemo.demoId
      const path = `../../sites/demos/pc/app/${getPath(modeState.pathName)}/${state.currDemo?.codeFiles[0]}`

      // 查找源码  查找组件
      state.currDemoSrc = await demoStr[path]()
      const comp = await demoVue[path]()

      state.demoLoading = false
      state.comp = hooks.markRaw(comp.default)
      modeFn.cacheCtx()
      modeFn.pushToUrl()
    }
```

可知，是通过动态组件引用 sites 中示例代码进行展示

至此dev调试是如何实现示例代码演示已经清晰了

# 组件是如何运行的

通过上面工程目录的介绍，通常来说，开发组件只需要关注3个模块：

- packages/theme - 组件样式
- packages/renderless - 组件逻辑
- packages/vue - 组件模板

通常来说，如果是开发新组件或修改组件功能，只需要关注以上三个模块

由于opentiny是一款跨框架的组件库，因此还有重要的一个模块 `packages/vue-common` ,该模块是 vue2.6\vue2.7\vue3版本的适配层。目的是为了抹平框架版本差异。但通常来说，不太需要进行修改。

# 各模块间关联关系
